{"version":3,"sources":["webpack://@flarum/tags/webpack/bootstrap","webpack://@flarum/tags/external \"flarum.core.compat['Model']\"","webpack://@flarum/tags/external \"flarum.core.compat['extend']\"","webpack://@flarum/tags/./src/common/utils/sortTags.js","webpack://@flarum/tags/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/tags/./src/common/helpers/tagIcon.js","webpack://@flarum/tags/./src/common/helpers/tagLabel.js","webpack://@flarum/tags/./src/common/helpers/tagsLabel.js","webpack://@flarum/tags/external \"flarum.core.compat['components/Button']\"","webpack://@flarum/tags/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flarum/tags/./src/common/models/Tag.js","webpack://@flarum/tags/external \"flarum.core.compat['utils/extract']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/classList']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/PermissionGrid']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/mixin']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/computed']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/Page']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/Modal']\"","webpack://@flarum/tags/./src/common/compat.js","webpack://@flarum/tags/external \"flarum.core\"","webpack://@flarum/tags/./src/admin/addTagsPermissionScope.js","webpack://@flarum/tags/./src/admin/addTagPermission.js","webpack://@flarum/tags/./node_modules/html5sortable/dist/html5sortable.es.js","webpack://@flarum/tags/./src/admin/components/EditTagModal.js","webpack://@flarum/tags/./src/admin/components/TagSettingsModal.js","webpack://@flarum/tags/./src/admin/components/TagsPage.js","webpack://@flarum/tags/./src/admin/addTagsPane.js","webpack://@flarum/tags/./src/admin/addTagsHomePageOption.js","webpack://@flarum/tags/./src/admin/addTagChangePermission.js","webpack://@flarum/tags/./src/admin/compat.js","webpack://@flarum/tags/./src/admin/index.js","webpack://@flarum/tags/external \"flarum.core.compat['components/PermissionDropdown']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/Dropdown']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/AdminNav']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/AdminLinkButton']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/ItemList']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/string']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/SettingsModal']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/BasicsPage']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/SettingDropdown']\"","webpack://@flarum/tags/./admin.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","sortTags","tags","slice","sort","a","b","aPos","position","bPos","discussionCount","aParent","parent","bParent","_inheritsLoose","subClass","superClass","constructor","__proto__","tagIcon","tag","attrs","settings","hasIcon","icon","useColor","className","classList","style","color","backgroundColor","tagLabel","link","extract","tagText","app","translator","trans","imagePath","title","description","href","route","slug","config","src","height","tagsLabel","children","forEach","length","showInTagLabels","push","_extends","assign","target","arguments","source","apply","this","Tag","mixin","Model","attribute","backgroundUrl","backgroundMode","hasOne","defaultSort","isChild","isHidden","lastPostedAt","transformDate","lastPostedDiscussion","isRestricted","canStartDiscussion","canAddToDiscussion","displayOrder","showonHomePage","bannerImagePath","isPrimary","computed","override","original","permission","tagPrefix","match","substr","map","required","extend","PermissionGrid","items","store","all","filter","add","id","label","onremove","save","render","item","indexOf","PermissionDropdown","component","allowGuest","Dropdown","buttonClassName","caretIcon","Button","onclick","addData","element","undefined","h5s","data","_filter","nodes","selector","NodeList","HTMLCollection","Array","Error","from","nodeType","matches","stores","Map","Store","_config","_placeholder","_data","set","mergedConfig","entries","configurable","setConfig","has","getConfig","placeholder","HTMLElement","setData","getData","deleteData","delete","sortableElement","addEventListener","eventName","callback","removeEventListener","addAttribute","setAttribute","removeAttribute","_offset","parentElement","getClientRects","rect","left","window","pageXOffset","right","top","pageYOffset","bottom","_debounce","func","wait","timeout","args","_i","clearTimeout","setTimeout","_index","elementList","isInDom","parentNode","insertNode","referenceNode","newElement","insertBefore","nextElementSibling","insertAfter","_serialize","sortableContainer","customItemSerializer","customContainerSerializer","serializedItem","serializedContainer","isSortable","serializedItems","node","html","outerHTML","index","container","itemCount","_makePlaceholder","placeholderClass","_a","includes","tagName","document","createElement","innerHTML","split","_getElementHeight","getComputedStyle","int","parseInt","getPropertyValue","isNaN","reduce","sum","_getHandles","querySelector","shadowRoot","getEventTarget","event","composedPath","defaultDragImage","draggedElement","elementOffset","posX","pageX","posY","pageY","setDragImage","customDragImage","Event","dataTransfer","dragImage","effectAllowed","_listsConnected","destination","origin","acceptFrom","sel","defaultConfiguration","connectWith","disableIEFix","copy","draggingClass","hoverClass","debounce","throttleTime","maxItems","itemSerializer","containerSerializer","dragging","draggingHeight","originContainer","originIndex","originElementIndex","originItemsBeforeUpdate","previousContainer","destinationItemsBeforeUpdate","enableHoverClass","enable","hoverClasses_1","fn","threshold","_this","lastEventTimestamp","now","Date","_throttle","buttons","_b","remove","_removeItemEvents","_getDragging","draggedItem","sortable","ditem","cloneNode","appendChild","display","oldDisplay","_removeSortableData","_removeItemData","findSortable","find","el","findDragElement","options","itemlist","ele","contains","_enableSortable","opts","handles","handle","dragDrop","_reloadSortable","sortableElements","method","String","querySelectorAll","test","configKey","console","warn","customPlaceholder","listItems","tempContainer","e","stopImmediatePropagation","getAttribute","dragItem","dispatchEvent","CustomEvent","detail","elementIndex","originalTarget","itemsBeforeUpdate","visiblePlaceholder","values","preventDefault","stopPropagation","originItems","destinationContainer","destinationItems","destinationElementIndex","destinationIndex","debouncedDragOverEnter","forcePlaceholderSize","thisHeight","placeholderIndex","thisIndex","deadZone","offsetTop","placeAfter","offsetHeight","placeholders","onDragOverEnter","dropEffect","concat","destroy","_destroySortable","disable","_disableSortable","__testing","EditTagModal","init","props","createRecord","prop","content","fields","toArray","oninput","withAttr","type","checked","onchange","ItemList","tabindex","loading","exists","submitData","onsubmit","then","hide","response","handleErrors","confirm","pushData","attributes","relationships","redraw","Modal","TagSettingsModal","setMinTags","minTags","maxTags","Math","max","form","minPrimaryTags","setting","maxPrimaryTags","minSecondaryTags","maxSecondaryTags","min","bidi","SettingsModal","tagItem","data-id","modal","show","child","TagsPage","view","localeCompare","$","onSortUpdate","HTMLOListElement","HTMLUListElement","getById","order","j","request","url","forum","strategy","Page","routes","path","extensionSettings","AdminNav","AdminLinkButton","BasicsPage","minutes","allow_tag_change","SettingDropdown","defaultLabel","transChoice","count","addTagsHomePageOption","addTagChangePermission","addTagsPane","addTagPermission","addTagsPermissionScope","initializers","models","tagsCompat"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 49);\n","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['extend'];","export default function sortTags(tags) {\r\n  return tags.slice(0).sort((a, b) => {\r\n    const aPos = a.position();\r\n    const bPos = b.position();\r\n\r\n    // If they're both secondary tags, sort them by their discussions count,\r\n    // descending.\r\n    if (aPos === null && bPos === null)\r\n      return b.discussionCount() - a.discussionCount();\r\n\r\n    // If just one is a secondary tag, then the primary tag should\r\n    // come first.\r\n    if (bPos === null) return -1;\r\n    if (aPos === null) return 1;\r\n\r\n    // If we've made it this far, we know they're both primary tags. So we'll\r\n    // need to see if they have parents.\r\n    const aParent = a.parent();\r\n    const bParent = b.parent();\r\n\r\n    // If they both have the same parent, then their positions are local,\r\n    // so we can compare them directly.\r\n    if (aParent === bParent) return aPos - bPos;\r\n\r\n    // If they are both child tags, then we will compare the positions of their\r\n    // parents.\r\n    else if (aParent && bParent)\r\n      return aParent.position() - bParent.position();\r\n\r\n    // If we are comparing a child tag with its parent, then we let the parent\r\n    // come first. If we are comparing an unrelated parent/child, then we\r\n    // compare both of the parents.\r\n    else if (aParent)\r\n      return aParent === b ? 1 : aParent.position() - bPos;\r\n\r\n    else if (bParent)\r\n      return bParent === a ? -1 : aPos - bParent.position();\r\n\r\n    return 0;\r\n  });\r\n}\r\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import classList from 'flarum/utils/classList';\r\n\r\nexport default function tagIcon(tag, attrs = {}, settings = {}) {\r\n  const hasIcon = tag && tag.icon();\r\n  const { useColor = true } = settings;\r\n\r\n  attrs.className = classList([\r\n    attrs.className,\r\n    'icon',\r\n    hasIcon ? tag.icon() : 'TagIcon'\r\n  ]);\r\n\r\n  if (tag) {\r\n    attrs.style = attrs.style || {};\r\n\r\n    if (hasIcon) {\r\n      attrs.style.color = useColor ? tag.color() : '';\r\n    } else {\r\n      attrs.style.backgroundColor = tag.color();\r\n    }\r\n\r\n  } else {\r\n    attrs.className += ' untagged';\r\n  }\r\n\r\n  return hasIcon ? <i {...attrs}/> : <span {...attrs}/>;\r\n}\r\n","import extract from \"flarum/utils/extract\";\r\nimport tagIcon from \"./tagIcon\";\r\n\r\nexport default function tagLabel(tag, attrs = {}) {\r\n  attrs.style = attrs.style || {};\r\n  attrs.className = \"TagLabel \" + (attrs.className || \"\");\r\n\r\n  const link = extract(attrs, \"link\");\r\n  const tagText = tag\r\n    ? tag.name()\r\n    : app.translator.trans(\"flarum-tags.lib.deleted_tag_text\");\r\n  const imagePath = tag.imagePath();\r\n\r\n  if (tag) {\r\n    const color = tag.color();\r\n    if (color) {\r\n      attrs.style.backgroundColor = attrs.style.color = color;\r\n      attrs.className += \" colored\";\r\n    }\r\n\r\n    if (link) {\r\n      attrs.title = tag.description() || \"\";\r\n      attrs.href = app.route(\"tag\", { tags: tag.slug() });\r\n      attrs.config = m.route;\r\n    }\r\n    if (imagePath != \"\") {\r\n      attrs.className = \"\";\r\n    }\r\n  } else {\r\n    attrs.className += \" untagged\";\r\n  }\r\n\r\n  return m(\r\n    link ? \"a\" : \"span\",\r\n    attrs,\r\n    <span className=\"TagLabel-text\">\r\n      {tag\r\n        ? imagePath != \"\"\r\n          ? m(\"img\", { src: imagePath, height: \"16.5em\" })\r\n          : tagText\r\n        : tag.icon() && tagIcon(tag, {}, { useColor: false })}{\" \"}\r\n    </span>\r\n  );\r\n}\r\n","import extract from 'flarum/utils/extract';\r\nimport tagLabel from './tagLabel';\r\nimport sortTags from '../utils/sortTags';\r\n\r\nexport default function tagsLabel(tags, attrs = {}) {\r\n  const children = [];\r\n  const link = extract(attrs, 'link');\r\n\r\n  attrs.className = 'TagsLabel ' + (attrs.className || '');\r\n\r\n  if (tags) {\r\n    sortTags(tags).forEach(tag => {\r\n      if (tag || tags.length === 1) {\r\n        if(tag.showInTagLabels())\r\n        children.push(tagLabel(tag, {link}));\r\n      }\r\n    });\r\n  } else {\r\n    children.push(tagLabel());\r\n  }\r\n\r\n  return <span {...attrs}>{children}</span>;\r\n}\r\n","module.exports = flarum.core.compat['components/Button'];","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import Model from \"flarum/Model\";\r\nimport mixin from \"flarum/utils/mixin\";\r\nimport computed from \"flarum/utils/computed\";\r\n\r\nexport default class Tag extends mixin(Model, {\r\n  name: Model.attribute(\"name\"),\r\n  slug: Model.attribute(\"slug\"),\r\n  description: Model.attribute(\"description\"),\r\n\r\n  color: Model.attribute(\"color\"),\r\n  backgroundUrl: Model.attribute(\"backgroundUrl\"),\r\n  backgroundMode: Model.attribute(\"backgroundMode\"),\r\n  icon: Model.attribute(\"icon\"),\r\n\r\n  position: Model.attribute(\"position\"),\r\n  parent: Model.hasOne(\"parent\"),\r\n  defaultSort: Model.attribute(\"defaultSort\"),\r\n  isChild: Model.attribute(\"isChild\"),\r\n  isHidden: Model.attribute(\"isHidden\"),\r\n\r\n  discussionCount: Model.attribute(\"discussionCount\"),\r\n  lastPostedAt: Model.attribute(\"lastPostedAt\", Model.transformDate),\r\n  lastPostedDiscussion: Model.hasOne(\"lastPostedDiscussion\"),\r\n\r\n  isRestricted: Model.attribute(\"isRestricted\"),\r\n  canStartDiscussion: Model.attribute(\"canStartDiscussion\"),\r\n  canAddToDiscussion: Model.attribute(\"canAddToDiscussion\"),\r\n  imagePath: Model.attribute(\"imagePath\"),\r\n  showInTagLabels: Model.attribute(\"showInTagLabels\"),\r\n  displayOrder: Model.attribute(\"displayOrder\"),\r\n  showonHomePage: Model.attribute(\"showonHomePage\"),\r\n  bannerImagePath: Model.attribute(\"bannerImagePath\"),\r\n  isPrimary: computed(\r\n    \"position\",\r\n    \"parent\",\r\n    (position, parent) => position !== null && parent === false\r\n  ),\r\n}) {}\r\n","module.exports = flarum.core.compat['utils/extract'];","module.exports = flarum.core.compat['utils/classList'];","module.exports = flarum.core.compat['components/PermissionGrid'];","module.exports = flarum.core.compat['utils/mixin'];","module.exports = flarum.core.compat['utils/computed'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/Modal'];","import sortTags from './utils/sortTags';\r\nimport Tag from './models/Tag';\r\nimport tagsLabel from './helpers/tagsLabel';\r\nimport tagIcon from './helpers/tagIcon';\r\nimport tagLabel from './helpers/tagLabel';\r\n\r\nexport default {\r\n  'tags/utils/sortTags': sortTags,\r\n  'tags/models/Tag': Tag,\r\n  'tags/helpers/tagsLabel': tagsLabel,\r\n  'tags/helpers/tagIcon': tagIcon,\r\n  'tags/helpers/tagLabel': tagLabel\r\n};\r\n","module.exports = flarum.core;","import { extend, override } from 'flarum/extend';\r\nimport PermissionGrid from 'flarum/components/PermissionGrid';\r\nimport PermissionDropdown from 'flarum/components/PermissionDropdown';\r\nimport Dropdown from 'flarum/components/Dropdown';\r\nimport Button from 'flarum/components/Button';\r\n\r\nimport tagLabel from '../common/helpers/tagLabel';\r\nimport tagIcon from '../common/helpers/tagIcon';\r\nimport sortTags from '../common/utils/sortTags';\r\n\r\nexport default function() {\r\n  override(app, 'getRequiredPermissions', (original, permission) => {\r\n    const tagPrefix = permission.match(/^tag\\d+\\./);\r\n\r\n    if (tagPrefix) {\r\n      const globalPermission = permission.substr(tagPrefix[0].length);\r\n\r\n      const required = original(globalPermission);\r\n\r\n      return required.map(required => tagPrefix[0] + required);\r\n    }\r\n\r\n    return original(permission);\r\n  });\r\n\r\n  extend(PermissionGrid.prototype, 'scopeItems', items => {\r\n    sortTags(app.store.all('tags'))\r\n      .filter(tag => tag.isRestricted())\r\n      .forEach(tag => items.add('tag' + tag.id(), {\r\n        label: tagLabel(tag),\r\n        onremove: () => tag.save({isRestricted: false}),\r\n        render: item => {\r\n          if (item.permission === 'viewDiscussions'\r\n            || item.permission === 'startDiscussion'\r\n            || (item.permission && item.permission.indexOf('discussion.') === 0)) {\r\n            return PermissionDropdown.component({\r\n              permission: 'tag' + tag.id() + '.' + item.permission,\r\n              allowGuest: item.allowGuest\r\n            });\r\n          }\r\n\r\n          return '';\r\n        }\r\n      }));\r\n  });\r\n\r\n  extend(PermissionGrid.prototype, 'scopeControlItems', items => {\r\n    const tags = sortTags(app.store.all('tags').filter(tag => !tag.isRestricted()));\r\n\r\n    if (tags.length) {\r\n      items.add('tag', Dropdown.component({\r\n        className: 'Dropdown--restrictByTag',\r\n        buttonClassName: 'Button Button--text',\r\n        label: app.translator.trans('flarum-tags.admin.permissions.restrict_by_tag_heading'),\r\n        icon: 'fas fa-plus',\r\n        caretIcon: null,\r\n        children: tags.map(tag => Button.component({\r\n          icon: true,\r\n          children: [tagIcon(tag, {className: 'Button-icon'}), ' ', tag.name()],\r\n          onclick: () => tag.save({isRestricted: true})\r\n        }))\r\n      }));\r\n    }\r\n  });\r\n}\r\n","import { extend } from 'flarum/extend';\r\nimport PermissionGrid from 'flarum/components/PermissionGrid';\r\n\r\nexport default function() {\r\n  extend(PermissionGrid.prototype, 'moderateItems', items => {\r\n    items.add('tag', {\r\n      icon: 'fas fa-tag',\r\n      label: app.translator.trans('flarum-tags.admin.permissions.tag_discussions_label'),\r\n      permission: 'discussion.tag'\r\n    }, 95);\r\n  });\r\n}\r\n","/*\n * HTML5Sortable package\n * https://github.com/lukasoppermann/html5sortable\n *\n * Maintained by Lukas Oppermann <lukas@vea.re>\n *\n * Released under the MIT license.\n */\n/**\n * Get or set data on element\n * @param {HTMLElement} element\n * @param {string} key\n * @param {any} value\n * @return {*}\n */\nfunction addData(element, key, value) {\n    if (value === undefined) {\n        return element && element.h5s && element.h5s.data && element.h5s.data[key];\n    }\n    else {\n        element.h5s = element.h5s || {};\n        element.h5s.data = element.h5s.data || {};\n        element.h5s.data[key] = value;\n    }\n}\n/**\n * Remove data from element\n * @param {HTMLElement} element\n */\nfunction removeData(element) {\n    if (element.h5s) {\n        delete element.h5s.data;\n    }\n}\n\n/* eslint-env browser */\n/**\n * Filter only wanted nodes\n * @param {NodeList|HTMLCollection|Array} nodes\n * @param {String} selector\n * @returns {Array}\n */\nvar _filter = (function (nodes, selector) {\n    if (!(nodes instanceof NodeList || nodes instanceof HTMLCollection || nodes instanceof Array)) {\n        throw new Error('You must provide a nodeList/HTMLCollection/Array of elements to be filtered.');\n    }\n    if (typeof selector !== 'string') {\n        return Array.from(nodes);\n    }\n    return Array.from(nodes).filter(function (item) { return item.nodeType === 1 && item.matches(selector); });\n});\n\n/* eslint-env browser */\nvar stores = new Map();\n/**\n * Stores data & configurations per Sortable\n * @param {Object} config\n */\nvar Store = /** @class */ (function () {\n    function Store() {\n        this._config = new Map(); // eslint-disable-line no-undef\n        this._placeholder = undefined; // eslint-disable-line no-undef\n        this._data = new Map(); // eslint-disable-line no-undef\n    }\n    Object.defineProperty(Store.prototype, \"config\", {\n        /**\n         * get the configuration map of a class instance\n         * @method config\n         * @return {object}\n         */\n        get: function () {\n            // transform Map to object\n            var config = {};\n            this._config.forEach(function (value, key) {\n                config[key] = value;\n            });\n            // return object\n            return config;\n        },\n        /**\n         * set the configuration of a class instance\n         * @method config\n         * @param {object} config object of configurations\n         */\n        set: function (config) {\n            if (typeof config !== 'object') {\n                throw new Error('You must provide a valid configuration object to the config setter.');\n            }\n            // combine config with default\n            var mergedConfig = Object.assign({}, config);\n            // add config to map\n            this._config = new Map(Object.entries(mergedConfig));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * set individual configuration of a class instance\n     * @method setConfig\n     * @param  key valid configuration key\n     * @param  value any value\n     * @return void\n     */\n    Store.prototype.setConfig = function (key, value) {\n        if (!this._config.has(key)) {\n            throw new Error(\"Trying to set invalid configuration item: \" + key);\n        }\n        // set config\n        this._config.set(key, value);\n    };\n    /**\n     * get an individual configuration of a class instance\n     * @method getConfig\n     * @param  key valid configuration key\n     * @return any configuration value\n     */\n    Store.prototype.getConfig = function (key) {\n        if (!this._config.has(key)) {\n            throw new Error(\"Invalid configuration item requested: \" + key);\n        }\n        return this._config.get(key);\n    };\n    Object.defineProperty(Store.prototype, \"placeholder\", {\n        /**\n         * get the placeholder for a class instance\n         * @method placeholder\n         * @return {HTMLElement|null}\n         */\n        get: function () {\n            return this._placeholder;\n        },\n        /**\n         * set the placeholder for a class instance\n         * @method placeholder\n         * @param {HTMLElement} placeholder\n         * @return {void}\n         */\n        set: function (placeholder) {\n            if (!(placeholder instanceof HTMLElement) && placeholder !== null) {\n                throw new Error('A placeholder must be an html element or null.');\n            }\n            this._placeholder = placeholder;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * set an data entry\n     * @method setData\n     * @param {string} key\n     * @param {any} value\n     * @return {void}\n     */\n    Store.prototype.setData = function (key, value) {\n        if (typeof key !== 'string') {\n            throw new Error(\"The key must be a string.\");\n        }\n        this._data.set(key, value);\n    };\n    /**\n     * get an data entry\n     * @method getData\n     * @param {string} key an existing key\n     * @return {any}\n     */\n    Store.prototype.getData = function (key) {\n        if (typeof key !== 'string') {\n            throw new Error(\"The key must be a string.\");\n        }\n        return this._data.get(key);\n    };\n    /**\n     * delete an data entry\n     * @method deleteData\n     * @param {string} key an existing key\n     * @return {boolean}\n     */\n    Store.prototype.deleteData = function (key) {\n        if (typeof key !== 'string') {\n            throw new Error(\"The key must be a string.\");\n        }\n        return this._data.delete(key);\n    };\n    return Store;\n}());\n/**\n * @param {HTMLElement} sortableElement\n * @returns {Class: Store}\n */\nvar store = (function (sortableElement) {\n    // if sortableElement is wrong type\n    if (!(sortableElement instanceof HTMLElement)) {\n        throw new Error('Please provide a sortable to the store function.');\n    }\n    // create new instance if not avilable\n    if (!stores.has(sortableElement)) {\n        stores.set(sortableElement, new Store());\n    }\n    // return instance\n    return stores.get(sortableElement);\n});\n\n/**\n * @param {Array|HTMLElement} element\n * @param {Function} callback\n * @param {string} event\n */\nfunction addEventListener(element, eventName, callback) {\n    if (element instanceof Array) {\n        for (var i = 0; i < element.length; ++i) {\n            addEventListener(element[i], eventName, callback);\n        }\n        return;\n    }\n    element.addEventListener(eventName, callback);\n    store(element).setData(\"event\" + eventName, callback);\n}\n/**\n * @param {Array<HTMLElement>|HTMLElement} element\n * @param {string} eventName\n */\nfunction removeEventListener(element, eventName) {\n    if (element instanceof Array) {\n        for (var i = 0; i < element.length; ++i) {\n            removeEventListener(element[i], eventName);\n        }\n        return;\n    }\n    element.removeEventListener(eventName, store(element).getData(\"event\" + eventName));\n    store(element).deleteData(\"event\" + eventName);\n}\n\n/**\n * @param {Array<HTMLElement>|HTMLElement} element\n * @param {string} attribute\n * @param {string} value\n */\nfunction addAttribute(element, attribute, value) {\n    if (element instanceof Array) {\n        for (var i = 0; i < element.length; ++i) {\n            addAttribute(element[i], attribute, value);\n        }\n        return;\n    }\n    element.setAttribute(attribute, value);\n}\n/**\n * @param {Array|HTMLElement} element\n * @param {string} attribute\n */\nfunction removeAttribute(element, attribute) {\n    if (element instanceof Array) {\n        for (var i = 0; i < element.length; ++i) {\n            removeAttribute(element[i], attribute);\n        }\n        return;\n    }\n    element.removeAttribute(attribute);\n}\n\n/**\n * @param {HTMLElement} element\n * @returns {Object}\n */\nvar _offset = (function (element) {\n    if (!element.parentElement || element.getClientRects().length === 0) {\n        throw new Error('target element must be part of the dom');\n    }\n    var rect = element.getClientRects()[0];\n    return {\n        left: rect.left + window.pageXOffset,\n        right: rect.right + window.pageXOffset,\n        top: rect.top + window.pageYOffset,\n        bottom: rect.bottom + window.pageYOffset\n    };\n});\n\n/**\n * Creates and returns a new debounced version of the passed function which will postpone its execution until after wait milliseconds have elapsed\n * @param {Function} func to debounce\n * @param {number} time to wait before calling function with latest arguments, 0 - no debounce\n * @returns {function} - debounced function\n */\nvar _debounce = (function (func, wait) {\n    if (wait === void 0) { wait = 0; }\n    var timeout;\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        clearTimeout(timeout);\n        timeout = setTimeout(function () {\n            func.apply(void 0, args);\n        }, wait);\n    };\n});\n\n/* eslint-env browser */\n/**\n * Get position of the element relatively to its sibling elements\n * @param {HTMLElement} element\n * @returns {number}\n */\nvar _index = (function (element, elementList) {\n    if (!(element instanceof HTMLElement) || !(elementList instanceof NodeList || elementList instanceof HTMLCollection || elementList instanceof Array)) {\n        throw new Error('You must provide an element and a list of elements.');\n    }\n    return Array.from(elementList).indexOf(element);\n});\n\n/* eslint-env browser */\n/**\n * Test whether element is in DOM\n * @param {HTMLElement} element\n * @returns {boolean}\n */\nvar isInDom = (function (element) {\n    if (!(element instanceof HTMLElement)) {\n        throw new Error('Element is not a node element.');\n    }\n    return element.parentNode !== null;\n});\n\n/* eslint-env browser */\n/**\n * Insert node before or after target\n * @param {HTMLElement} referenceNode - reference element\n * @param {HTMLElement} newElement - element to be inserted\n * @param {String} position - insert before or after reference element\n */\nvar insertNode = function (referenceNode, newElement, position) {\n    if (!(referenceNode instanceof HTMLElement) || !(referenceNode.parentElement instanceof HTMLElement)) {\n        throw new Error('target and element must be a node');\n    }\n    referenceNode.parentElement.insertBefore(newElement, (position === 'before' ? referenceNode : referenceNode.nextElementSibling));\n};\n/**\n * Insert before target\n * @param {HTMLElement} target\n * @param {HTMLElement} element\n */\nvar insertBefore = function (target, element) { return insertNode(target, element, 'before'); };\n/**\n * Insert after target\n * @param {HTMLElement} target\n * @param {HTMLElement} element\n */\nvar insertAfter = function (target, element) { return insertNode(target, element, 'after'); };\n\n/* eslint-env browser */\n/**\n * Filter only wanted nodes\n * @param {HTMLElement} sortableContainer\n * @param {Function} customSerializer\n * @returns {Array}\n */\nvar _serialize = (function (sortableContainer, customItemSerializer, customContainerSerializer) {\n    if (customItemSerializer === void 0) { customItemSerializer = function (serializedItem, sortableContainer) { return serializedItem; }; }\n    if (customContainerSerializer === void 0) { customContainerSerializer = function (serializedContainer) { return serializedContainer; }; }\n    // check for valid sortableContainer\n    if (!(sortableContainer instanceof HTMLElement) || !sortableContainer.isSortable === true) {\n        throw new Error('You need to provide a sortableContainer to be serialized.');\n    }\n    // check for valid serializers\n    if (typeof customItemSerializer !== 'function' || typeof customContainerSerializer !== 'function') {\n        throw new Error('You need to provide a valid serializer for items and the container.');\n    }\n    // get options\n    var options = addData(sortableContainer, 'opts');\n    var item = options.items;\n    // serialize container\n    var items = _filter(sortableContainer.children, item);\n    var serializedItems = items.map(function (item) {\n        return {\n            parent: sortableContainer,\n            node: item,\n            html: item.outerHTML,\n            index: _index(item, items)\n        };\n    });\n    // serialize container\n    var container = {\n        node: sortableContainer,\n        itemCount: serializedItems.length\n    };\n    return {\n        container: customContainerSerializer(container),\n        items: serializedItems.map(function (item) { return customItemSerializer(item, sortableContainer); })\n    };\n});\n\n/* eslint-env browser */\n/**\n * create a placeholder element\n * @param {HTMLElement} sortableElement a single sortable\n * @param {string|undefined} placeholder a string representing an html element\n * @param {string} placeholderClasses a string representing the classes that should be added to the placeholder\n */\nvar _makePlaceholder = (function (sortableElement, placeholder, placeholderClass) {\n    var _a;\n    if (placeholderClass === void 0) { placeholderClass = 'sortable-placeholder'; }\n    if (!(sortableElement instanceof HTMLElement)) {\n        throw new Error('You must provide a valid element as a sortable.');\n    }\n    // if placeholder is not an element\n    if (!(placeholder instanceof HTMLElement) && placeholder !== undefined) {\n        throw new Error('You must provide a valid element as a placeholder or set ot to undefined.');\n    }\n    // if no placeholder element is given\n    if (placeholder === undefined) {\n        if (['UL', 'OL'].includes(sortableElement.tagName)) {\n            placeholder = document.createElement('li');\n        }\n        else if (['TABLE', 'TBODY'].includes(sortableElement.tagName)) {\n            placeholder = document.createElement('tr');\n            // set colspan to always all rows, otherwise the item can only be dropped in first column\n            placeholder.innerHTML = '<td colspan=\"100\"></td>';\n        }\n        else {\n            placeholder = document.createElement('div');\n        }\n    }\n    // add classes to placeholder\n    if (typeof placeholderClass === 'string') {\n        (_a = placeholder.classList).add.apply(_a, placeholderClass.split(' '));\n    }\n    return placeholder;\n});\n\n/* eslint-env browser */\n/**\n * Get height of an element including padding\n * @param {HTMLElement} element an dom element\n */\nvar _getElementHeight = (function (element) {\n    if (!(element instanceof HTMLElement)) {\n        throw new Error('You must provide a valid dom element');\n    }\n    // get calculated style of element\n    var style = window.getComputedStyle(element);\n    // pick applicable properties, convert to int and reduce by adding\n    return ['height', 'padding-top', 'padding-bottom']\n        .map(function (key) {\n        var int = parseInt(style.getPropertyValue(key), 10);\n        return isNaN(int) ? 0 : int;\n    })\n        .reduce(function (sum, value) { return sum + value; });\n});\n\n/* eslint-env browser */\n/**\n * get handle or return item\n * @param {Array<HTMLElement>} items\n * @param {string} selector\n */\nvar _getHandles = (function (items, selector) {\n    if (!(items instanceof Array)) {\n        throw new Error('You must provide a Array of HTMLElements to be filtered.');\n    }\n    if (typeof selector !== 'string') {\n        return items;\n    }\n    return items\n        // remove items without handle from array\n        .filter(function (item) {\n        return item.querySelector(selector) instanceof HTMLElement ||\n            (item.shadowRoot && item.shadowRoot.querySelector(selector) instanceof HTMLElement);\n    })\n        // replace item with handle in array\n        .map(function (item) {\n        return item.querySelector(selector) || (item.shadowRoot && item.shadowRoot.querySelector(selector));\n    });\n});\n\n/**\n * @param {Event} event\n * @returns {HTMLElement}\n */\nvar getEventTarget = (function (event) {\n    return (event.composedPath && event.composedPath()[0]) || event.target;\n});\n\n/* eslint-env browser */\n/**\n * defaultDragImage returns the current item as dragged image\n * @param {HTMLElement} draggedElement - the item that the user drags\n * @param {object} elementOffset - an object with the offsets top, left, right & bottom\n * @param {Event} event - the original drag event object\n * @return {object} with element, posX and posY properties\n */\nvar defaultDragImage = function (draggedElement, elementOffset, event) {\n    return {\n        element: draggedElement,\n        posX: event.pageX - elementOffset.left,\n        posY: event.pageY - elementOffset.top\n    };\n};\n/**\n * attaches an element as the drag image to an event\n * @param {Event} event - the original drag event object\n * @param {HTMLElement} draggedElement - the item that the user drags\n * @param {Function} customDragImage - function to create a custom dragImage\n * @return void\n */\nvar setDragImage = (function (event, draggedElement, customDragImage) {\n    // check if event is provided\n    if (!(event instanceof Event)) {\n        throw new Error('setDragImage requires a DragEvent as the first argument.');\n    }\n    // check if draggedElement is provided\n    if (!(draggedElement instanceof HTMLElement)) {\n        throw new Error('setDragImage requires the dragged element as the second argument.');\n    }\n    // set default function of none provided\n    if (!customDragImage) {\n        customDragImage = defaultDragImage;\n    }\n    // check if setDragImage method is available\n    if (event.dataTransfer && event.dataTransfer.setDragImage) {\n        // get the elements offset\n        var elementOffset = _offset(draggedElement);\n        // get the dragImage\n        var dragImage = customDragImage(draggedElement, elementOffset, event);\n        // check if custom function returns correct values\n        if (!(dragImage.element instanceof HTMLElement) || typeof dragImage.posX !== 'number' || typeof dragImage.posY !== 'number') {\n            throw new Error('The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].');\n        }\n        // needs to be set for HTML5 drag & drop to work\n        event.dataTransfer.effectAllowed = 'copyMove';\n        // Firefox requires it to use the event target's id for the data\n        event.dataTransfer.setData('text/plain', getEventTarget(event).id);\n        // set the drag image on the event\n        event.dataTransfer.setDragImage(dragImage.element, dragImage.posX, dragImage.posY);\n    }\n});\n\n/**\n * Check if curList accepts items from destList\n * @param {sortable} destination the container an item is move to\n * @param {sortable} origin the container an item comes from\n */\nvar _listsConnected = (function (destination, origin) {\n    // check if valid sortable\n    if (destination.isSortable === true) {\n        var acceptFrom = store(destination).getConfig('acceptFrom');\n        // check if acceptFrom is valid\n        if (acceptFrom !== null && acceptFrom !== false && typeof acceptFrom !== 'string') {\n            throw new Error('HTML5Sortable: Wrong argument, \"acceptFrom\" must be \"null\", \"false\", or a valid selector string.');\n        }\n        if (acceptFrom !== null) {\n            return acceptFrom !== false && acceptFrom.split(',').filter(function (sel) {\n                return sel.length > 0 && origin.matches(sel);\n            }).length > 0;\n        }\n        // drop in same list\n        if (destination === origin) {\n            return true;\n        }\n        // check if lists are connected with connectWith\n        if (store(destination).getConfig('connectWith') !== undefined && store(destination).getConfig('connectWith') !== null) {\n            return store(destination).getConfig('connectWith') === store(origin).getConfig('connectWith');\n        }\n    }\n    return false;\n});\n\n/**\n * default configurations\n */\nvar defaultConfiguration = {\n    items: null,\n    // deprecated\n    connectWith: null,\n    // deprecated\n    disableIEFix: null,\n    acceptFrom: null,\n    copy: false,\n    placeholder: null,\n    placeholderClass: 'sortable-placeholder',\n    draggingClass: 'sortable-dragging',\n    hoverClass: false,\n    debounce: 0,\n    throttleTime: 100,\n    maxItems: 0,\n    itemSerializer: undefined,\n    containerSerializer: undefined,\n    customDragImage: null\n};\n\n/**\n * make sure a function is only called once within the given amount of time\n * @param {Function} fn the function to throttle\n * @param {number} threshold time limit for throttling\n */\n// must use function to keep this context\nfunction _throttle (fn, threshold) {\n    var _this = this;\n    if (threshold === void 0) { threshold = 250; }\n    // check function\n    if (typeof fn !== 'function') {\n        throw new Error('You must provide a function as the first argument for throttle.');\n    }\n    // check threshold\n    if (typeof threshold !== 'number') {\n        throw new Error('You must provide a number as the second argument for throttle.');\n    }\n    var lastEventTimestamp = null;\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var now = Date.now();\n        if (lastEventTimestamp === null || now - lastEventTimestamp >= threshold) {\n            lastEventTimestamp = now;\n            fn.apply(_this, args);\n        }\n    };\n}\n\n/* eslint-env browser */\n/**\n * enable or disable hoverClass on mouseenter/leave if container Items\n * @param {sortable} sortableContainer a valid sortableContainer\n * @param {boolean} enable enable or disable event\n */\n// export default (sortableContainer: sortable, enable: boolean) => {\nvar enableHoverClass = (function (sortableContainer, enable) {\n    if (typeof store(sortableContainer).getConfig('hoverClass') === 'string') {\n        var hoverClasses_1 = store(sortableContainer).getConfig('hoverClass').split(' ');\n        // add class on hover\n        if (enable === true) {\n            addEventListener(sortableContainer, 'mousemove', _throttle(function (event) {\n                // check of no mouse button was pressed when mousemove started == no drag\n                if (event.buttons === 0) {\n                    _filter(sortableContainer.children, store(sortableContainer).getConfig('items')).forEach(function (item) {\n                        var _a, _b;\n                        if (item !== event.target) {\n                            (_a = item.classList).remove.apply(_a, hoverClasses_1);\n                        }\n                        else {\n                            (_b = item.classList).add.apply(_b, hoverClasses_1);\n                        }\n                    });\n                }\n            }, store(sortableContainer).getConfig('throttleTime')));\n            // remove class on leave\n            addEventListener(sortableContainer, 'mouseleave', function () {\n                _filter(sortableContainer.children, store(sortableContainer).getConfig('items')).forEach(function (item) {\n                    var _a;\n                    (_a = item.classList).remove.apply(_a, hoverClasses_1);\n                });\n            });\n            // remove events\n        }\n        else {\n            removeEventListener(sortableContainer, 'mousemove');\n            removeEventListener(sortableContainer, 'mouseleave');\n        }\n    }\n});\n\n/* eslint-env browser */\n/*\n * variables global to the plugin\n */\nvar dragging;\nvar draggingHeight;\n/*\n * Keeps track of the initialy selected list, where 'dragstart' event was triggered\n * It allows us to move the data in between individual Sortable List instances\n */\n// Origin List - data from before any item was changed\nvar originContainer;\nvar originIndex;\nvar originElementIndex;\nvar originItemsBeforeUpdate;\n// Previous Sortable Container - we dispatch as sortenter event when a\n// dragged item enters a sortableContainer for the first time\nvar previousContainer;\n// Destination List - data from before any item was changed\nvar destinationItemsBeforeUpdate;\n/**\n * remove event handlers from items\n * @param {Array|NodeList} items\n */\nvar _removeItemEvents = function (items) {\n    removeEventListener(items, 'dragstart');\n    removeEventListener(items, 'dragend');\n    removeEventListener(items, 'dragover');\n    removeEventListener(items, 'dragenter');\n    removeEventListener(items, 'drop');\n    removeEventListener(items, 'mouseenter');\n    removeEventListener(items, 'mouseleave');\n};\n/**\n * _getDragging returns the current element to drag or\n * a copy of the element.\n * Is Copy Active for sortable\n * @param {HTMLElement} draggedItem - the item that the user drags\n * @param {HTMLElement} sortable a single sortable\n */\nvar _getDragging = function (draggedItem, sortable) {\n    var ditem = draggedItem;\n    if (store(sortable).getConfig('copy') === true) {\n        ditem = draggedItem.cloneNode(true);\n        addAttribute(ditem, 'aria-copied', 'true');\n        draggedItem.parentElement.appendChild(ditem);\n        ditem.style.display = 'none';\n        ditem.oldDisplay = draggedItem.style.display;\n    }\n    return ditem;\n};\n/**\n * Remove data from sortable\n * @param {HTMLElement} sortable a single sortable\n */\nvar _removeSortableData = function (sortable) {\n    removeData(sortable);\n    removeAttribute(sortable, 'aria-dropeffect');\n};\n/**\n * Remove data from items\n * @param {Array<HTMLElement>|HTMLElement} items\n */\nvar _removeItemData = function (items) {\n    removeAttribute(items, 'aria-grabbed');\n    removeAttribute(items, 'aria-copied');\n    removeAttribute(items, 'draggable');\n    removeAttribute(items, 'role');\n};\n/**\n * find sortable from element. travels up parent element until found or null.\n * @param {HTMLElement} element a single sortable\n * @param {Event} event - the current event. We need to pass it to be able to\n * find Sortable whith shadowRoot (document fragment has no parent)\n */\nfunction findSortable(element, event) {\n    if (event.composedPath) {\n        return event.composedPath().find(function (el) { return el.isSortable; });\n    }\n    while (element.isSortable !== true) {\n        element = element.parentElement;\n    }\n    return element;\n}\n/**\n * Dragging event is on the sortable element. finds the top child that\n * contains the element.\n * @param {HTMLElement} sortableElement a single sortable\n * @param {HTMLElement} element is that being dragged\n */\nfunction findDragElement(sortableElement, element) {\n    var options = addData(sortableElement, 'opts');\n    var items = _filter(sortableElement.children, options.items);\n    var itemlist = items.filter(function (ele) {\n        return ele.contains(element) || (ele.shadowRoot && ele.shadowRoot.contains(element));\n    });\n    return itemlist.length > 0 ? itemlist[0] : element;\n}\n/**\n * Destroy the sortable\n * @param {HTMLElement} sortableElement a single sortable\n */\nvar _destroySortable = function (sortableElement) {\n    var opts = addData(sortableElement, 'opts') || {};\n    var items = _filter(sortableElement.children, opts.items);\n    var handles = _getHandles(items, opts.handle);\n    // remove event handlers & data from sortable\n    removeEventListener(sortableElement, 'dragover');\n    removeEventListener(sortableElement, 'dragenter');\n    removeEventListener(sortableElement, 'drop');\n    // remove event data from sortable\n    _removeSortableData(sortableElement);\n    // remove event handlers & data from items\n    removeEventListener(handles, 'mousedown');\n    _removeItemEvents(items);\n    _removeItemData(items);\n};\n/**\n * Enable the sortable\n * @param {HTMLElement} sortableElement a single sortable\n */\nvar _enableSortable = function (sortableElement) {\n    var opts = addData(sortableElement, 'opts');\n    var items = _filter(sortableElement.children, opts.items);\n    var handles = _getHandles(items, opts.handle);\n    addAttribute(sortableElement, 'aria-dropeffect', 'move');\n    addData(sortableElement, '_disabled', 'false');\n    addAttribute(handles, 'draggable', 'true');\n    // @todo: remove this fix\n    // IE FIX for ghost\n    // can be disabled as it has the side effect that other events\n    // (e.g. click) will be ignored\n    if (opts.disableIEFix === false) {\n        var spanEl = (document || window.document).createElement('span');\n        if (typeof spanEl.dragDrop === 'function') {\n            addEventListener(handles, 'mousedown', function () {\n                if (items.indexOf(this) !== -1) {\n                    this.dragDrop();\n                }\n                else {\n                    var parent = this.parentElement;\n                    while (items.indexOf(parent) === -1) {\n                        parent = parent.parentElement;\n                    }\n                    parent.dragDrop();\n                }\n            });\n        }\n    }\n};\n/**\n * Disable the sortable\n * @param {HTMLElement} sortableElement a single sortable\n */\nvar _disableSortable = function (sortableElement) {\n    var opts = addData(sortableElement, 'opts');\n    var items = _filter(sortableElement.children, opts.items);\n    var handles = _getHandles(items, opts.handle);\n    addAttribute(sortableElement, 'aria-dropeffect', 'none');\n    addData(sortableElement, '_disabled', 'true');\n    addAttribute(handles, 'draggable', 'false');\n    removeEventListener(handles, 'mousedown');\n};\n/**\n * Reload the sortable\n * @param {HTMLElement} sortableElement a single sortable\n * @description events need to be removed to not be double bound\n */\nvar _reloadSortable = function (sortableElement) {\n    var opts = addData(sortableElement, 'opts');\n    var items = _filter(sortableElement.children, opts.items);\n    var handles = _getHandles(items, opts.handle);\n    addData(sortableElement, '_disabled', 'false');\n    // remove event handlers from items\n    _removeItemEvents(items);\n    removeEventListener(handles, 'mousedown');\n    // remove event handlers from sortable\n    removeEventListener(sortableElement, 'dragover');\n    removeEventListener(sortableElement, 'dragenter');\n    removeEventListener(sortableElement, 'drop');\n};\n/**\n * Public sortable object\n * @param {Array|NodeList} sortableElements\n * @param {object|string} options|method\n */\nfunction sortable(sortableElements, options) {\n    // get method string to see if a method is called\n    var method = String(options);\n    options = options || {};\n    // check if the user provided a selector instead of an element\n    if (typeof sortableElements === 'string') {\n        sortableElements = document.querySelectorAll(sortableElements);\n    }\n    // if the user provided an element, return it in an array to keep the return value consistant\n    if (sortableElements instanceof HTMLElement) {\n        sortableElements = [sortableElements];\n    }\n    sortableElements = Array.prototype.slice.call(sortableElements);\n    if (/serialize/.test(method)) {\n        return sortableElements.map(function (sortableContainer) {\n            var opts = addData(sortableContainer, 'opts');\n            return _serialize(sortableContainer, opts.itemSerializer, opts.containerSerializer);\n        });\n    }\n    sortableElements.forEach(function (sortableElement) {\n        if (/enable|disable|destroy/.test(method)) {\n            return sortable[method](sortableElement);\n        }\n        // log deprecation\n        ['connectWith', 'disableIEFix'].forEach(function (configKey) {\n            if (options.hasOwnProperty(configKey) && options[configKey] !== null) {\n                console.warn(\"HTML5Sortable: You are using the deprecated configuration \\\"\" + configKey + \"\\\". This will be removed in an upcoming version, make sure to migrate to the new options when updating.\");\n            }\n        });\n        // merge options with default options\n        options = Object.assign({}, defaultConfiguration, store(sortableElement).config, options);\n        // init data store for sortable\n        store(sortableElement).config = options;\n        // set options on sortable\n        addData(sortableElement, 'opts', options);\n        // property to define as sortable\n        sortableElement.isSortable = true;\n        // reset sortable\n        _reloadSortable(sortableElement);\n        // initialize\n        var listItems = _filter(sortableElement.children, options.items);\n        // create element if user defined a placeholder element as a string\n        var customPlaceholder;\n        if (options.placeholder !== null && options.placeholder !== undefined) {\n            var tempContainer = document.createElement(sortableElement.tagName);\n            if (options.placeholder instanceof HTMLElement) {\n                tempContainer.appendChild(options.placeholder);\n            }\n            else {\n                tempContainer.innerHTML = options.placeholder;\n            }\n            customPlaceholder = tempContainer.children[0];\n        }\n        // add placeholder\n        store(sortableElement).placeholder = _makePlaceholder(sortableElement, customPlaceholder, options.placeholderClass);\n        addData(sortableElement, 'items', options.items);\n        if (options.acceptFrom) {\n            addData(sortableElement, 'acceptFrom', options.acceptFrom);\n        }\n        else if (options.connectWith) {\n            addData(sortableElement, 'connectWith', options.connectWith);\n        }\n        _enableSortable(sortableElement);\n        addAttribute(listItems, 'role', 'option');\n        addAttribute(listItems, 'aria-grabbed', 'false');\n        // enable hover class\n        enableHoverClass(sortableElement, true);\n        /*\n         Handle drag events on draggable items\n         Handle is set at the sortableElement level as it will bubble up\n         from the item\n         */\n        addEventListener(sortableElement, 'dragstart', function (e) {\n            // ignore dragstart events\n            var target = getEventTarget(e);\n            if (target.isSortable === true) {\n                return;\n            }\n            e.stopImmediatePropagation();\n            if ((options.handle && !target.matches(options.handle)) || target.getAttribute('draggable') === 'false') {\n                return;\n            }\n            var sortableContainer = findSortable(target, e);\n            var dragItem = findDragElement(sortableContainer, target);\n            // grab values\n            originItemsBeforeUpdate = _filter(sortableContainer.children, options.items);\n            originIndex = originItemsBeforeUpdate.indexOf(dragItem);\n            originElementIndex = _index(dragItem, sortableContainer.children);\n            originContainer = sortableContainer;\n            // add transparent clone or other ghost to cursor\n            setDragImage(e, dragItem, options.customDragImage);\n            // cache selsection & add attr for dragging\n            draggingHeight = _getElementHeight(dragItem);\n            dragItem.classList.add(options.draggingClass);\n            dragging = _getDragging(dragItem, sortableContainer);\n            addAttribute(dragging, 'aria-grabbed', 'true');\n            // dispatch sortstart event on each element in group\n            sortableContainer.dispatchEvent(new CustomEvent('sortstart', {\n                detail: {\n                    origin: {\n                        elementIndex: originElementIndex,\n                        index: originIndex,\n                        container: originContainer\n                    },\n                    item: dragging,\n                    originalTarget: target\n                }\n            }));\n        });\n        /*\n         We are capturing targetSortable before modifications with 'dragenter' event\n        */\n        addEventListener(sortableElement, 'dragenter', function (e) {\n            var target = getEventTarget(e);\n            var sortableContainer = findSortable(target, e);\n            if (sortableContainer && sortableContainer !== previousContainer) {\n                destinationItemsBeforeUpdate = _filter(sortableContainer.children, addData(sortableContainer, 'items'))\n                    .filter(function (item) { return item !== store(sortableElement).placeholder; });\n                sortableContainer.dispatchEvent(new CustomEvent('sortenter', {\n                    detail: {\n                        origin: {\n                            elementIndex: originElementIndex,\n                            index: originIndex,\n                            container: originContainer\n                        },\n                        destination: {\n                            container: sortableContainer,\n                            itemsBeforeUpdate: destinationItemsBeforeUpdate\n                        },\n                        item: dragging,\n                        originalTarget: target\n                    }\n                }));\n            }\n            previousContainer = sortableContainer;\n        });\n        /*\n         * Dragend Event - https://developer.mozilla.org/en-US/docs/Web/Events/dragend\n         * Fires each time dragEvent end, or ESC pressed\n         * We are using it to clean up any draggable elements and placeholders\n         */\n        addEventListener(sortableElement, 'dragend', function (e) {\n            if (!dragging) {\n                return;\n            }\n            dragging.classList.remove(options.draggingClass);\n            addAttribute(dragging, 'aria-grabbed', 'false');\n            if (dragging.getAttribute('aria-copied') === 'true' && addData(dragging, 'dropped') !== 'true') {\n                dragging.remove();\n            }\n            dragging.style.display = dragging.oldDisplay;\n            delete dragging.oldDisplay;\n            var visiblePlaceholder = Array.from(stores.values()).map(function (data) { return data.placeholder; })\n                .filter(function (placeholder) { return placeholder instanceof HTMLElement; })\n                .filter(isInDom)[0];\n            if (visiblePlaceholder) {\n                visiblePlaceholder.remove();\n            }\n            // dispatch sortstart event on each element in group\n            sortableElement.dispatchEvent(new CustomEvent('sortstop', {\n                detail: {\n                    origin: {\n                        elementIndex: originElementIndex,\n                        index: originIndex,\n                        container: originContainer\n                    },\n                    item: dragging\n                }\n            }));\n            previousContainer = null;\n            dragging = null;\n            draggingHeight = null;\n        });\n        /*\n         * Drop Event - https://developer.mozilla.org/en-US/docs/Web/Events/drop\n         * Fires when valid drop target area is hit\n         */\n        addEventListener(sortableElement, 'drop', function (e) {\n            if (!_listsConnected(sortableElement, dragging.parentElement)) {\n                return;\n            }\n            e.preventDefault();\n            e.stopPropagation();\n            addData(dragging, 'dropped', 'true');\n            // get the one placeholder that is currently visible\n            var visiblePlaceholder = Array.from(stores.values()).map(function (data) {\n                return data.placeholder;\n            })\n                // filter only HTMLElements\n                .filter(function (placeholder) { return placeholder instanceof HTMLElement; })\n                // filter only elements in DOM\n                .filter(isInDom)[0];\n            // attach element after placeholder\n            insertAfter(visiblePlaceholder, dragging);\n            // remove placeholder from dom\n            visiblePlaceholder.remove();\n            /*\n             * Fires Custom Event - 'sortstop'\n             */\n            sortableElement.dispatchEvent(new CustomEvent('sortstop', {\n                detail: {\n                    origin: {\n                        elementIndex: originElementIndex,\n                        index: originIndex,\n                        container: originContainer\n                    },\n                    item: dragging\n                }\n            }));\n            var placeholder = store(sortableElement).placeholder;\n            var originItems = _filter(originContainer.children, options.items)\n                .filter(function (item) { return item !== placeholder; });\n            var destinationContainer = this.isSortable === true ? this : this.parentElement;\n            var destinationItems = _filter(destinationContainer.children, addData(destinationContainer, 'items'))\n                .filter(function (item) { return item !== placeholder; });\n            var destinationElementIndex = _index(dragging, Array.from(dragging.parentElement.children)\n                .filter(function (item) { return item !== placeholder; }));\n            var destinationIndex = _index(dragging, destinationItems);\n            /*\n             * When a list item changed container lists or index within a list\n             * Fires Custom Event - 'sortupdate'\n             */\n            if (originElementIndex !== destinationElementIndex || originContainer !== destinationContainer) {\n                sortableElement.dispatchEvent(new CustomEvent('sortupdate', {\n                    detail: {\n                        origin: {\n                            elementIndex: originElementIndex,\n                            index: originIndex,\n                            container: originContainer,\n                            itemsBeforeUpdate: originItemsBeforeUpdate,\n                            items: originItems\n                        },\n                        destination: {\n                            index: destinationIndex,\n                            elementIndex: destinationElementIndex,\n                            container: destinationContainer,\n                            itemsBeforeUpdate: destinationItemsBeforeUpdate,\n                            items: destinationItems\n                        },\n                        item: dragging\n                    }\n                }));\n            }\n        });\n        var debouncedDragOverEnter = _debounce(function (sortableElement, element, pageY) {\n            if (!dragging) {\n                return;\n            }\n            // set placeholder height if forcePlaceholderSize option is set\n            if (options.forcePlaceholderSize) {\n                store(sortableElement).placeholder.style.height = draggingHeight + 'px';\n            }\n            // if element the draggedItem is dragged onto is within the array of all elements in list\n            // (not only items, but also disabled, etc.)\n            if (Array.from(sortableElement.children).indexOf(element) > -1) {\n                var thisHeight = _getElementHeight(element);\n                var placeholderIndex = _index(store(sortableElement).placeholder, element.parentElement.children);\n                var thisIndex = _index(element, element.parentElement.children);\n                // Check if `element` is bigger than the draggable. If it is, we have to define a dead zone to prevent flickering\n                if (thisHeight > draggingHeight) {\n                    // Dead zone?\n                    var deadZone = thisHeight - draggingHeight;\n                    var offsetTop = _offset(element).top;\n                    if (placeholderIndex < thisIndex && pageY < offsetTop) {\n                        return;\n                    }\n                    if (placeholderIndex > thisIndex &&\n                        pageY > offsetTop + thisHeight - deadZone) {\n                        return;\n                    }\n                }\n                if (dragging.oldDisplay === undefined) {\n                    dragging.oldDisplay = dragging.style.display;\n                }\n                if (dragging.style.display !== 'none') {\n                    dragging.style.display = 'none';\n                }\n                // To avoid flicker, determine where to position the placeholder\n                // based on where the mouse pointer is relative to the elements\n                // vertical center.\n                var placeAfter = false;\n                try {\n                    var elementMiddle = _offset(element).top + element.offsetHeight / 2;\n                    placeAfter = pageY >= elementMiddle;\n                }\n                catch (e) {\n                    placeAfter = placeholderIndex < thisIndex;\n                }\n                if (placeAfter) {\n                    insertAfter(element, store(sortableElement).placeholder);\n                }\n                else {\n                    insertBefore(element, store(sortableElement).placeholder);\n                }\n                // get placeholders from all stores & remove all but current one\n                Array.from(stores.values())\n                    // remove empty values\n                    .filter(function (data) { return data.placeholder !== undefined; })\n                    // foreach placeholder in array if outside of current sorableContainer -> remove from DOM\n                    .forEach(function (data) {\n                    if (data.placeholder !== store(sortableElement).placeholder) {\n                        data.placeholder.remove();\n                    }\n                });\n            }\n            else {\n                // get all placeholders from store\n                var placeholders = Array.from(stores.values())\n                    .filter(function (data) { return data.placeholder !== undefined; })\n                    .map(function (data) {\n                    return data.placeholder;\n                });\n                // check if element is not in placeholders\n                if (placeholders.indexOf(element) === -1 && sortableElement === element && !_filter(element.children, options.items).length) {\n                    placeholders.forEach(function (element) { return element.remove(); });\n                    element.appendChild(store(sortableElement).placeholder);\n                }\n            }\n        }, options.debounce);\n        // Handle dragover and dragenter events on draggable items\n        var onDragOverEnter = function (e) {\n            var element = e.target;\n            var sortableElement = element.isSortable === true ? element : findSortable(element, e);\n            element = findDragElement(sortableElement, element);\n            if (!dragging || !_listsConnected(sortableElement, dragging.parentElement) || addData(sortableElement, '_disabled') === 'true') {\n                return;\n            }\n            var options = addData(sortableElement, 'opts');\n            if (parseInt(options.maxItems) && _filter(sortableElement.children, addData(sortableElement, 'items')).length >= parseInt(options.maxItems) && dragging.parentElement !== sortableElement) {\n                return;\n            }\n            e.preventDefault();\n            e.stopPropagation();\n            e.dataTransfer.dropEffect = store(sortableElement).getConfig('copy') === true ? 'copy' : 'move';\n            debouncedDragOverEnter(sortableElement, element, e.pageY);\n        };\n        addEventListener(listItems.concat(sortableElement), 'dragover', onDragOverEnter);\n        addEventListener(listItems.concat(sortableElement), 'dragenter', onDragOverEnter);\n    });\n    return sortableElements;\n}\nsortable.destroy = function (sortableElement) {\n    _destroySortable(sortableElement);\n};\nsortable.enable = function (sortableElement) {\n    _enableSortable(sortableElement);\n};\nsortable.disable = function (sortableElement) {\n    _disableSortable(sortableElement);\n};\n/* START.TESTS_ONLY */\nsortable.__testing = {\n    // add internal methods here for testing purposes\n    _data: addData,\n    _removeItemEvents: _removeItemEvents,\n    _removeItemData: _removeItemData,\n    _removeSortableData: _removeSortableData\n};\n\nexport default sortable;\n","import Modal from \"flarum/components/Modal\";\r\nimport Button from \"flarum/components/Button\";\r\nimport ItemList from \"flarum/utils/ItemList\";\r\nimport { slug } from \"flarum/utils/string\";\r\n\r\nimport tagLabel from \"../../common/helpers/tagLabel\";\r\n\r\n/**\r\n * The `EditTagModal` component shows a modal dialog which allows the user\r\n * to create or edit a tag.\r\n */\r\nexport default class EditTagModal extends Modal {\r\n  init() {\r\n    super.init();\r\n\r\n    this.tag = this.props.tag || app.store.createRecord(\"tags\");\r\n\r\n    this.name = m.prop(this.tag.name() || \"\");\r\n    this.slug = m.prop(this.tag.slug() || \"\");\r\n    this.description = m.prop(this.tag.description() || \"\");\r\n    this.color = m.prop(this.tag.color() || \"\");\r\n    this.icon = m.prop(this.tag.icon() || \"\");\r\n    this.isHidden = m.prop(this.tag.isHidden() || false);\r\n    this.imagePath = m.prop(this.tag.imagePath() || \"\");\r\n    this.showInTagLabels = m.prop(this.tag.showInTagLabels() || false);\r\n    this.displayOrder = m.prop(this.tag.displayOrder() || false);\r\n    this.showonHomePage = m.prop(this.tag.showonHomePage() || false);\r\n    this.bannerImagePath = m.prop(this.tag.bannerImagePath() || false);\r\n  }\r\n\r\n  className() {\r\n    return \"EditTagModal Modal--small\";\r\n  }\r\n\r\n  title() {\r\n    return this.name()\r\n      ? tagLabel({\r\n          name: this.name,\r\n          color: this.color,\r\n          icon: this.icon,\r\n          imagePath: this.imagePath,\r\n        })\r\n      : app.translator.trans(\"flarum-tags.admin.edit_tag.title\");\r\n  }\r\n\r\n  content() {\r\n    return (\r\n      <div className=\"Modal-body\">\r\n        <div className=\"Form\">\r\n          {this.fields().toArray()}\r\n\r\n          <div className=\"Form-group\">\r\n            <label>Image Path</label>\r\n            <input\r\n              className=\"FormControl\"\r\n              placeholder=\"Enter image URL\"\r\n              value={this.imagePath()}\r\n              oninput={m.withAttr(\"value\", this.imagePath)}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"Form-group\">\r\n            <label>Banner Image Path</label>\r\n            <input\r\n              className=\"FormControl\"\r\n              placeholder=\"Enter Banner image URL\"\r\n              value={this.bannerImagePath()}\r\n              oninput={m.withAttr(\"value\", this.bannerImagePath)}\r\n            />\r\n          </div>\r\n          <div className=\"Form-group\">\r\n            <div>\r\n              <label className=\"checkbox\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  value=\"1\"\r\n                  checked={this.showInTagLabels()}\r\n                  onchange={m.withAttr(\"checked\", this.showInTagLabels)}\r\n                />\r\n                Show Label in Label List?\r\n              </label>\r\n            </div>\r\n          </div>\r\n          <div className=\"Form-group\">\r\n            <label>Display Order On Home Page</label>\r\n            <input\r\n              className=\"FormControl\"\r\n              value={this.displayOrder()}\r\n              oninput={m.withAttr(\"value\", this.displayOrder)}\r\n            />\r\n          </div>\r\n          <div className=\"Form-group\">\r\n            <div>\r\n              <label className=\"checkbox\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  value=\"1\"\r\n                  checked={this.showonHomePage()}\r\n                  onchange={m.withAttr(\"checked\", this.showonHomePage)}\r\n                />\r\n                Show Tag Deals On Home Page?\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  fields() {\r\n    const items = new ItemList();\r\n\r\n    items.add(\r\n      \"name\",\r\n      <div className=\"Form-group\">\r\n        <label>\r\n          {app.translator.trans(\"flarum-tags.admin.edit_tag.name_label\")}\r\n        </label>\r\n        <input\r\n          className=\"FormControl\"\r\n          placeholder={app.translator.trans(\r\n            \"flarum-tags.admin.edit_tag.name_placeholder\"\r\n          )}\r\n          value={this.name()}\r\n          oninput={(e) => {\r\n            this.name(e.target.value);\r\n            this.slug(slug(e.target.value));\r\n          }}\r\n        />\r\n      </div>,\r\n      50\r\n    );\r\n\r\n    items.add(\r\n      \"slug\",\r\n      <div className=\"Form-group\">\r\n        <label>\r\n          {app.translator.trans(\"flarum-tags.admin.edit_tag.slug_label\")}\r\n        </label>\r\n        <input\r\n          className=\"FormControl\"\r\n          value={this.slug()}\r\n          oninput={m.withAttr(\"value\", this.slug)}\r\n        />\r\n      </div>,\r\n      40\r\n    );\r\n\r\n    items.add(\r\n      \"description\",\r\n      <div className=\"Form-group\">\r\n        <label>\r\n          {app.translator.trans(\"flarum-tags.admin.edit_tag.description_label\")}\r\n        </label>\r\n        <textarea\r\n          className=\"FormControl\"\r\n          value={this.description()}\r\n          oninput={m.withAttr(\"value\", this.description)}\r\n        />\r\n      </div>,\r\n      30\r\n    );\r\n\r\n    items.add(\r\n      \"color\",\r\n      <div className=\"Form-group\">\r\n        <label>\r\n          {app.translator.trans(\"flarum-tags.admin.edit_tag.color_label\")}\r\n        </label>\r\n        <input\r\n          className=\"FormControl\"\r\n          placeholder=\"#aaaaaa\"\r\n          value={this.color()}\r\n          oninput={m.withAttr(\"value\", this.color)}\r\n        />\r\n      </div>,\r\n      20\r\n    );\r\n\r\n    items.add(\r\n      \"icon\",\r\n      <div className=\"Form-group\">\r\n        <label>\r\n          {app.translator.trans(\"flarum-tags.admin.edit_tag.icon_label\")}\r\n        </label>\r\n        <div className=\"helpText\">\r\n          {app.translator.trans(\"flarum-tags.admin.edit_tag.icon_text\", {\r\n            a: <a href=\"https://fontawesome.com/icons?m=free\" tabindex=\"-1\" />,\r\n          })}\r\n        </div>\r\n        <input\r\n          className=\"FormControl\"\r\n          placeholder=\"fas fa-bolt\"\r\n          value={this.icon()}\r\n          oninput={m.withAttr(\"value\", this.icon)}\r\n        />\r\n      </div>,\r\n      10\r\n    );\r\n\r\n    items.add(\r\n      \"hidden\",\r\n      <div className=\"Form-group\">\r\n        <div>\r\n          <label className=\"checkbox\">\r\n            <input\r\n              type=\"checkbox\"\r\n              value=\"1\"\r\n              checked={this.isHidden()}\r\n              onchange={m.withAttr(\"checked\", this.isHidden)}\r\n            />\r\n            {app.translator.trans(\"flarum-tags.admin.edit_tag.hide_label\")}\r\n          </label>\r\n        </div>\r\n      </div>,\r\n      10\r\n    );\r\n\r\n    items.add(\r\n      \"submit\",\r\n      <div className=\"Form-group\">\r\n        {Button.component({\r\n          type: \"submit\",\r\n          className: \"Button Button--primary EditTagModal-save\",\r\n          loading: this.loading,\r\n          children: app.translator.trans(\r\n            \"flarum-tags.admin.edit_tag.submit_button\"\r\n          ),\r\n        })}\r\n        {this.tag.exists ? (\r\n          <button\r\n            type=\"button\"\r\n            className=\"Button EditTagModal-delete\"\r\n            onclick={this.delete.bind(this)}\r\n          >\r\n            {app.translator.trans(\r\n              \"flarum-tags.admin.edit_tag.delete_tag_button\"\r\n            )}\r\n          </button>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>,\r\n      -10\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  submitData() {\r\n    return {\r\n      name: this.name(),\r\n      slug: this.slug(),\r\n      description: this.description(),\r\n      color: this.color(),\r\n      icon: this.icon(),\r\n      isHidden: this.isHidden(),\r\n      imagePath: this.imagePath(),\r\n      showInTagLabels: this.showInTagLabels(),\r\n      displayOrder: this.displayOrder(),\r\n      showonHomePage: this.showonHomePage(),\r\n      bannerImagePath: this.bannerImagePath(),\r\n    };\r\n  }\r\n\r\n  onsubmit(e) {\r\n    e.preventDefault();\r\n\r\n    this.loading = true;\r\n\r\n    this.tag.save(this.submitData()).then(\r\n      () => this.hide(),\r\n      (response) => {\r\n        this.loading = false;\r\n        this.handleErrors(response);\r\n      }\r\n    );\r\n  }\r\n\r\n  delete() {\r\n    if (\r\n      confirm(\r\n        app.translator.trans(\r\n          \"flarum-tags.admin.edit_tag.delete_tag_confirmation\"\r\n        )\r\n      )\r\n    ) {\r\n      const children = app.store\r\n        .all(\"tags\")\r\n        .filter((tag) => tag.parent() === this.tag);\r\n\r\n      this.tag.delete().then(() => {\r\n        children.forEach((tag) =>\r\n          tag.pushData({\r\n            attributes: { isChild: false },\r\n            relationships: { parent: null },\r\n          })\r\n        );\r\n        m.redraw();\r\n      });\r\n\r\n      this.hide();\r\n    }\r\n  }\r\n}\r\n","import SettingsModal from 'flarum/components/SettingsModal';\r\n\r\nexport default class TagSettingsModal extends SettingsModal {\r\n  setMinTags(minTags, maxTags, value) {\r\n    minTags(value);\r\n    maxTags(Math.max(value, maxTags()));\r\n  }\r\n\r\n  className() {\r\n    return 'TagSettingsModal Modal--small';\r\n  }\r\n\r\n  title() {\r\n    return app.translator.trans('flarum-tags.admin.tag_settings.title');\r\n  }\r\n\r\n  form() {\r\n    const minPrimaryTags = this.setting('flarum-tags.min_primary_tags', 0);\r\n    const maxPrimaryTags = this.setting('flarum-tags.max_primary_tags', 0);\r\n\r\n    const minSecondaryTags = this.setting('flarum-tags.min_secondary_tags', 0);\r\n    const maxSecondaryTags = this.setting('flarum-tags.max_secondary_tags', 0);\r\n\r\n    return [\r\n      <div className=\"Form-group\">\r\n        <label>{app.translator.trans('flarum-tags.admin.tag_settings.required_primary_heading')}</label>\r\n        <div className=\"helpText\">\r\n          {app.translator.trans('flarum-tags.admin.tag_settings.required_primary_text')}\r\n        </div>\r\n        <div className=\"TagSettingsModal-rangeInput\">\r\n          <input className=\"FormControl\"\r\n            type=\"number\"\r\n            min=\"0\"\r\n            value={minPrimaryTags()}\r\n            oninput={m.withAttr('value', this.setMinTags.bind(this, minPrimaryTags, maxPrimaryTags))} />\r\n          {app.translator.trans('flarum-tags.admin.tag_settings.range_separator_text')}\r\n          <input className=\"FormControl\"\r\n            type=\"number\"\r\n            min={minPrimaryTags()}\r\n            bidi={maxPrimaryTags} />\r\n        </div>\r\n      </div>,\r\n\r\n      <div className=\"Form-group\">\r\n        <label>{app.translator.trans('flarum-tags.admin.tag_settings.required_secondary_heading')}</label>\r\n        <div className=\"helpText\">\r\n          {app.translator.trans('flarum-tags.admin.tag_settings.required_secondary_text')}\r\n        </div>\r\n        <div className=\"TagSettingsModal-rangeInput\">\r\n          <input className=\"FormControl\"\r\n            type=\"number\"\r\n            min=\"0\"\r\n            value={minSecondaryTags()}\r\n            oninput={m.withAttr('value', this.setMinTags.bind(this, minSecondaryTags, maxSecondaryTags))} />\r\n          {app.translator.trans('flarum-tags.admin.tag_settings.range_separator_text')}\r\n          <input className=\"FormControl\"\r\n            type=\"number\"\r\n            min={minSecondaryTags()}\r\n            bidi={maxSecondaryTags} />\r\n        </div>\r\n      </div>\r\n    ];\r\n  }\r\n}\r\n","import sortable from 'html5sortable/dist/html5sortable.es.js';\r\n\r\nimport Page from 'flarum/components/Page';\r\nimport Button from 'flarum/components/Button';\r\n\r\nimport EditTagModal from './EditTagModal';\r\nimport TagSettingsModal from './TagSettingsModal';\r\nimport tagIcon from '../../common/helpers/tagIcon';\r\nimport sortTags from '../../common/utils/sortTags';\r\n\r\nfunction tagItem(tag) {\r\n  return (\r\n    <li data-id={tag.id()} style={{color: tag.color()}}>\r\n      <div className=\"TagListItem-info\">\r\n        {tagIcon(tag)}\r\n        <span className=\"TagListItem-name\">{tag.name()}</span>\r\n        {Button.component({\r\n          className: 'Button Button--link',\r\n          icon: 'fas fa-pencil-alt',\r\n          onclick: () => app.modal.show(new EditTagModal({tag}))\r\n        })}\r\n      </div>\r\n      {!tag.isChild() && tag.position() !== null ? (\r\n        <ol className=\"TagListItem-children\">\r\n          {sortTags(app.store.all('tags'))\r\n            .filter(child => child.parent() === tag)\r\n            .map(tagItem)}\r\n        </ol>\r\n      ) : ''}\r\n    </li>\r\n  );\r\n}\r\n\r\nexport default class TagsPage extends Page {\r\n  view() {\r\n    return (\r\n      <div className=\"TagsPage\">\r\n        <div className=\"TagsPage-header\">\r\n          <div className=\"container\">\r\n            <p>\r\n              {app.translator.trans('flarum-tags.admin.tags.about_tags_text')}\r\n            </p>\r\n            {Button.component({\r\n              className: 'Button Button--primary',\r\n              icon: 'fas fa-plus',\r\n              children: app.translator.trans('flarum-tags.admin.tags.create_tag_button'),\r\n              onclick: () => app.modal.show(new EditTagModal())\r\n            })}\r\n            {Button.component({\r\n              className: 'Button',\r\n              children: app.translator.trans('flarum-tags.admin.tags.settings_button'),\r\n              onclick: () => app.modal.show(new TagSettingsModal())\r\n            })}\r\n          </div>\r\n        </div>\r\n        <div className=\"TagsPage-list\">\r\n          <div className=\"container\">\r\n            <div className=\"TagGroup\">\r\n              <label>{app.translator.trans('flarum-tags.admin.tags.primary_heading')}</label>\r\n              <ol className=\"TagList TagList--primary\">\r\n                {sortTags(app.store.all('tags'))\r\n                  .filter(tag => tag.position() !== null && !tag.isChild())\r\n                  .map(tagItem)}\r\n              </ol>\r\n            </div>\r\n\r\n            <div className=\"TagGroup\">\r\n              <label>{app.translator.trans('flarum-tags.admin.tags.secondary_heading')}</label>\r\n              <ul className=\"TagList\">\r\n                {app.store.all('tags')\r\n                  .filter(tag => tag.position() === null)\r\n                  .sort((a, b) => a.name().localeCompare(b.name()))\r\n                  .map(tagItem)}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  config() {\r\n    sortable(this.$('ol, ul'), {\r\n      acceptFrom: 'ol,ul'\r\n    }).forEach(this.onSortUpdate.bind(this));\r\n  }\r\n\r\n  onSortUpdate(el) {\r\n    el.addEventListener('sortupdate', (e) => {\r\n      // If we've moved a tag from 'primary' to 'secondary', then we'll update\r\n      // its attributes in our local store so that when we redraw the change\r\n      // will be made.\r\n      if (e.detail.origin.container instanceof HTMLOListElement && e.detail.destination.container instanceof HTMLUListElement) {\r\n        app.store.getById('tags', e.detail.item.getAttribute('data-id')).pushData({\r\n          attributes: {\r\n            position: null,\r\n            isChild: false\r\n          },\r\n          relationships: {parent: null}\r\n        });\r\n      }\r\n\r\n      // Construct an array of primary tag IDs and their children, in the same\r\n      // order that they have been arranged in.\r\n      const order = this.$('.TagList--primary > li')\r\n        .map(function() {\r\n          return {\r\n            id: $(this).data('id'),\r\n            children: $(this).find('li')\r\n              .map(function() {\r\n                return $(this).data('id');\r\n              }).get()\r\n          };\r\n        }).get();\r\n\r\n      // Now that we have an accurate representation of the order which the\r\n      // primary tags are in, we will update the tag attributes in our local\r\n      // store to reflect this order.\r\n      order.forEach((tag, i) => {\r\n        const parent = app.store.getById('tags', tag.id);\r\n        parent.pushData({\r\n          attributes: {\r\n            position: i,\r\n            isChild: false\r\n          },\r\n          relationships: {parent: null}\r\n        });\r\n\r\n        tag.children.forEach((child, j) => {\r\n          app.store.getById('tags', child).pushData({\r\n            attributes: {\r\n              position: j,\r\n              isChild: true\r\n            },\r\n            relationships: {parent}\r\n          });\r\n        });\r\n      });\r\n\r\n      app.request({\r\n        url: app.forum.attribute('apiUrl') + '/tags/order',\r\n        method: 'POST',\r\n        data: {order}\r\n      });\r\n\r\n      // A diff redraw won't work here, because sortable has mucked around\r\n      // with the DOM which will confuse Mithril's diffing algorithm. Instead\r\n      // we force a full reconstruction of the DOM.\r\n      m.redraw.strategy('all');\r\n      m.redraw();\r\n    });\r\n  }\r\n}\r\n","import { extend } from 'flarum/extend';\r\nimport AdminNav from 'flarum/components/AdminNav';\r\nimport AdminLinkButton from 'flarum/components/AdminLinkButton';\r\n\r\nimport TagsPage from './components/TagsPage';\r\n\r\nexport default function() {\r\n  app.routes.tags = {path: '/tags', component: TagsPage.component()};\r\n\r\n  app.extensionSettings['flarum-tags'] = () => m.route(app.route('tags'));\r\n\r\n  extend(AdminNav.prototype, 'items', items => {\r\n    items.add('tags', AdminLinkButton.component({\r\n      href: app.route('tags'),\r\n      icon: 'fas fa-tags',\r\n      children: app.translator.trans('flarum-tags.admin.nav.tags_button'),\r\n      description: app.translator.trans('flarum-tags.admin.nav.tags_text')\r\n    }));\r\n  });\r\n}\r\n","import { extend } from 'flarum/extend';\r\nimport BasicsPage from 'flarum/components/BasicsPage';\r\n\r\nexport default function() {\r\n  extend(BasicsPage.prototype, 'homePageItems', items => {\r\n    items.add('tags', {\r\n      path: '/tags',\r\n      label: app.translator.trans('flarum-tags.admin.basics.tags_label')\r\n    });\r\n  });\r\n}\r\n","import { extend } from 'flarum/extend';\r\nimport PermissionGrid from 'flarum/components/PermissionGrid';\r\nimport SettingDropdown from 'flarum/components/SettingDropdown';\r\n\r\nexport default function() {\r\n  extend(PermissionGrid.prototype, 'startItems', items => {\r\n    items.add('allowTagChange', {\r\n      icon: 'fas fa-tag',\r\n      label: app.translator.trans('flarum-tags.admin.permissions.allow_edit_tags_label'),\r\n      setting: () => {\r\n        const minutes = parseInt(app.data.settings.allow_tag_change, 10);\r\n\r\n        return SettingDropdown.component({\r\n          defaultLabel: minutes\r\n            ? app.translator.transChoice('core.admin.permissions_controls.allow_some_minutes_button', minutes, {count: minutes})\r\n            : app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button'),\r\n          key: 'allow_tag_change',\r\n          options: [\r\n            {value: '-1', label: app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button')},\r\n            {value: '10', label: app.translator.trans('core.admin.permissions_controls.allow_ten_minutes_button')},\r\n            {value: 'reply', label: app.translator.trans('core.admin.permissions_controls.allow_until_reply_button')}\r\n          ]\r\n        });\r\n      }\r\n    }, 90);\r\n  });\r\n}\r\n","import compat from '../common/compat';\r\n\r\nimport addTagsHomePageOption from './addTagsHomePageOption';\r\nimport addTagChangePermission from './addTagChangePermission';\r\nimport addTagsPane from './addTagsPane';\r\nimport TagSettingsModal from './components/TagSettingsModal';\r\nimport TagsPage from './components/TagsPage';\r\nimport EditTagModal from './components/EditTagModal';\r\nimport addTagPermission from './addTagPermission';\r\nimport addTagsPermissionScope from './addTagsPermissionScope';\r\n\r\nexport default Object.assign(compat, {\r\n  'tags/addTagsHomePageOption': addTagsHomePageOption,\r\n  'tags/addTagChangePermission': addTagChangePermission,\r\n  'tags/addTagsPane': addTagsPane,\r\n  'tags/components/TagSettingsModal': TagSettingsModal,\r\n  'tags/components/TagsPage': TagsPage,\r\n  'tags/components/EditTagModal': EditTagModal,\r\n  'tags/addTagPermission': addTagPermission,\r\n  'tags/addTagsPermissionScope': addTagsPermissionScope,\r\n});\r\n","import Tag from '../common/models/Tag';\r\nimport addTagsPermissionScope from './addTagsPermissionScope';\r\nimport addTagPermission from './addTagPermission';\r\nimport addTagsPane from './addTagsPane';\r\nimport addTagsHomePageOption from './addTagsHomePageOption';\r\nimport addTagChangePermission from './addTagChangePermission';\r\n\r\napp.initializers.add('flarum-tags', app => {\r\n  app.store.models.tags = Tag;\r\n\r\n  addTagsPermissionScope();\r\n  addTagPermission();\r\n  addTagsPane();\r\n  addTagsHomePageOption();\r\n  addTagChangePermission();\r\n});\r\n\r\n\r\n// Expose compat API\r\nimport tagsCompat from './compat';\r\nimport { compat } from '@flarum/core/admin';\r\n\r\nObject.assign(compat, tagsCompat);\r\n","module.exports = flarum.core.compat['components/PermissionDropdown'];","module.exports = flarum.core.compat['components/Dropdown'];","module.exports = flarum.core.compat['components/AdminNav'];","module.exports = flarum.core.compat['components/AdminLinkButton'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['utils/string'];","module.exports = flarum.core.compat['components/SettingsModal'];","module.exports = flarum.core.compat['components/BasicsPage'];","module.exports = flarum.core.compat['components/SettingDropdown'];","/*\r\n * This file is part of Flarum.\r\n *\r\n * (c) Toby Zerner <toby.zerner@gmail.com>\r\n *\r\n * For the full copyright and license information, please view the LICENSE\r\n * file that was distributed with this source code.\r\n */\r\n\r\nexport * from './src/common';\r\nexport * from './src/admin';\r\n"],"sourceRoot":""}